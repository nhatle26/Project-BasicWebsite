<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lá»‹ch sá»­ Ä‘Æ¡n hÃ ng - Cá»­a hÃ ng hoa</title>
    <link rel="stylesheet" href="../style/style.css">
   
</head>
<body>
    <!-- HEADER -->
    <header>
        <nav>
            <a href="home.html" class="logo">ğŸŒ¹ Flower Shop</a>
            <div class="search-bar">
                <input type="text" id="searchInput" placeholder="TÃ¬m hoa, cháº­u, phá»¥ kiá»‡n...">
                <button onclick="searchProducts()">ğŸ”</button>
            </div>
            <div class="nav-menu">
                <a href="home.html">Trang chá»§</a>
                <a href="search.html">TÃ¬m kiáº¿m</a>
                <a href="cart.html" class="cart-icon">
                    ğŸ›’ Giá» hÃ ng
                    <span class="cart-badge" id="cartBadge" style="display: none;">0</span>
                </a>
                <a href="orders.html">ğŸ“¦ ÄÆ¡n hÃ ng</a>
                <a href="login.html" id="loginLink">ÄÄƒng nháº­p</a>
            </div>
        </nav>
    </header>

    <!-- MAIN CONTENT -->
    <div class="container">
        <h1>ğŸ“¦ Lá»‹ch sá»­ Ä‘Æ¡n hÃ ng</h1>
        
        <div class="orders-container">
            <div id="ordersContent">
                <!-- ÄÆ¡n hÃ ng sáº½ Ä‘Æ°á»£c render á»Ÿ Ä‘Ã¢y -->
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>ğŸŒ¹ Flower Shop</h3>
                <p>Cá»­a hÃ ng hoa tÆ°Æ¡i uy tÃ­n, cháº¥t lÆ°á»£ng cao.</p>
                <p>Giao hÃ ng nhanh chÃ³ng, giÃ¡ cáº£ há»£p lÃ½.</p>
            </div>
            <div class="footer-section">
                <h3>LiÃªn há»‡</h3>
                <p>ğŸ“ 123 Nguyá»…n Huá»‡, Q.1, TP.HCM</p>
                <p>ğŸ“ 0901 234 567</p>
                <p>âœ‰ï¸ contact@flowershop.vn</p>
            </div>
            <div class="footer-section">
                <h3>ChÃ­nh sÃ¡ch</h3>
                <p><a href="#">ChÃ­nh sÃ¡ch Ä‘á»•i tráº£</a></p>
                <p><a href="#">ChÃ­nh sÃ¡ch báº£o máº­t</a></p>
                <p><a href="#">Äiá»u khoáº£n sá»­ dá»¥ng</a></p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Â© 2024 Flower Shop. All rights reserved.</p>
        </div>
    </footer>

    <!-- IMPORT JS -->
    <script src="../js/cart.js"></script>
    <script src="../js/checkout.js"></script>
    <script src="../js/main.js"></script>
    <script>
        // Render danh sÃ¡ch Ä‘Æ¡n hÃ ng
        function renderOrders() {
            const ordersContent = document.getElementById('ordersContent');
            const currentUser = window.mainUtils.getCurrentUser();

            if (!currentUser) {
                ordersContent.innerHTML = `
                    <div class="empty-orders">
                        <div style="font-size: 80px; margin-bottom: 20px;">ğŸ”’</div>
                        <p style="font-size: 18px; margin-bottom: 20px;">Báº¡n cáº§n Ä‘Äƒng nháº­p Ä‘á»ƒ xem Ä‘Æ¡n hÃ ng</p>
                        <a href="login.html" class="btn btn-primary" style="display: inline-block; text-decoration: none;">ÄÄƒng nháº­p ngay</a>
                    </div>
                `;
                return;
            }

            const orders = window.checkoutUtils.getUserOrders(currentUser.email);

            if (orders.length === 0) {
                ordersContent.innerHTML = `
                    <div class="empty-orders">
                        <div style="font-size: 80px; margin-bottom: 20px;">ğŸ“¦</div>
                        <p style="font-size: 18px; margin-bottom: 20px;">Báº¡n chÆ°a cÃ³ Ä‘Æ¡n hÃ ng nÃ o</p>
                        <a href="index.html" class="btn btn-primary" style="display: inline-block; text-decoration: none;">Báº¯t Ä‘áº§u mua sáº¯m</a>
                    </div>
                `;
                return;
            }

            // Sáº¯p xáº¿p Ä‘Æ¡n hÃ ng má»›i nháº¥t lÃªn Ä‘áº§u
            orders.sort((a, b) => b.id - a.id);

            ordersContent.innerHTML = orders.map(order => `
                <div class="order-card">
                    <div class="order-header">
                        <div>
                            <div class="order-id">ÄÆ¡n hÃ ng #${order.id}</div>
                            <div style="color: #666; font-size: 12px; margin-top: 5px;">
                                ${new Date(order.createdAt).toLocaleString('vi-VN')}
                            </div>
                        </div>
                        <span class="order-status status-${order.status}">
                            ${window.checkoutUtils.getOrderStatusLabel(order.status)}
                        </span>
                    </div>

                    <div class="order-items">
                        <div style="font-weight: bold; margin-bottom: 10px;">Sáº£n pháº©m:</div>
                        ${order.items.map(item => `
                            <div class="order-item">
                                <span>${item.emoji} ${item.name} x${item.quantity}</span>
                                <span>${(item.price * item.quantity).toLocaleString('vi-VN')}Ä‘</span>
                            </div>
                        `).join('')}
                    </div>

                    <div style="font-size: 14px; color: #666; margin-bottom: 10px;">
                        <div><strong>NgÆ°á»i nháº­n:</strong> ${order.fullName}</div>
                        <div><strong>Äiá»‡n thoáº¡i:</strong> ${order.phone}</div>
                        <div><strong>Äá»‹a chá»‰:</strong> ${order.address}, ${order.district}, ${order.city}</div>
                        <div><strong>Thanh toÃ¡n:</strong> ${window.checkoutUtils.getPaymentMethodLabel(order.paymentMethod)}</div>
                    </div>

                    <div class="order-footer">
                        <div class="order-total">
                            Tá»•ng cá»™ng: ${order.total.toLocaleString('vi-VN')}Ä‘
                        </div>
                        <div>
                            <button class="btn btn-secondary btn-small" onclick="viewOrderDetail(${order.id})">Chi tiáº¿t</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Xem chi tiáº¿t Ä‘Æ¡n hÃ ng
        function viewOrderDetail(orderId) {
            const order = window.checkoutUtils.getOrderById(orderId);
            if (!order) return;

            alert(`Chi tiáº¿t Ä‘Æ¡n hÃ ng #${orderId}\n\n` +
                `Tráº¡ng thÃ¡i: ${window.checkoutUtils.getOrderStatusLabel(order.status)}\n` +
                `NgÃ y Ä‘áº·t: ${new Date(order.createdAt).toLocaleString('vi-VN')}\n` +
                `Tá»•ng tiá»n: ${order.total.toLocaleString('vi-VN')}Ä‘`);
        }

        // TÃ¬m kiáº¿m sáº£n pháº©m
        function searchProducts() {
            const query = document.getElementById('searchInput').value;
            if (query.trim()) {
                window.location.href = `search.html?q=${encodeURIComponent(query)}`;
            }
        }

        // Load trang
        document.addEventListener('DOMContentLoaded', function() {
            window.mainUtils.updateNavbar();
            window.mainUtils.updateCartBadge();
            renderOrders();
        });

        // Xá»­ lÃ½ Enter trong search
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') searchProducts();
        });
    </script>
</body>
</html>